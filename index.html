<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CRMonX Ultra App</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              gold: '#D4AF37',
              'gold-light': '#F9F1D8',
              cream: '#FFFAF0',
              black: '#0a0a0a',
              charcoal: '#222222',
              gray: {
                50: '#F9FAFB',
                100: '#F3F4F6',
                200: '#E5E7EB',
                300: '#D1D5DB',
                400: '#9CA3AF',
                500: '#6B7280',
              }
            },
            fontFamily: {
              sans: ['Manrope', 'sans-serif'],
              display: ['Antonio', 'sans-serif'],
            },
            boxShadow: {
              'soft': '0 10px 40px -10px rgba(0, 0, 0, 0.08)',
              'glow': '0 0 20px rgba(212, 175, 55, 0.4)',
              'floating': '0 20px 60px rgba(0,0,0,0.15)',
            }
          }
        }
      }
    </script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&family=Antonio:wght@100;200;300;400;500;600&display=swap" rel="stylesheet">

    <!-- Import Map for React & Lucide -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.263.1"
      }
    }
    </script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #FFFAF0;
            color: #222; 
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fadeIn { animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slideUp { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .animate-slideInRight { animation: slideInRight 0.3s ease-out forwards; }

        @keyframes pulse-gold {
            0%, 100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(212, 175, 55, 0); }
        }
        .animate-pulse-gold { animation: pulse-gold 2s infinite; }

        @keyframes typing {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
            100% { transform: translateY(0px); }
        }
        .typing-dot { animation: typing 1s infinite ease-in-out; }
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }
        
        .chat-bubble {
            border-bottom-left-radius: 1.5rem;
            border-bottom-right-radius: 1.5rem;
            border-top-right-radius: 1.5rem;
            border-top-left-radius: 0.25rem;
        }
        .chat-bubble.user {
            border-top-left-radius: 1.5rem;
            border-top-right-radius: 0.25rem;
            background: #111;
            color: white;
        }

        /* Safe Areas */
        .safe-area-top { padding-top: env(safe-area-inset-top); }
        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
          Users, AlertTriangle, Camera, Heart, Shield, 
          ListChecks, Activity, Save, PhoneCall, CheckCircle, 
          Clock, Menu, X, Plus, Trash2, ChevronDown, ChevronRight,
          ArrowLeft, Grid, User, LogIn, Lock, MessageCircle, Star, Diamond, Briefcase, LayoutDashboard, CalendarCheck, Bot, Send, Sun, CloudRain, CreditCard, Sparkles
        } from 'lucide-react';

        // --- SES & HAPTİK ---
        const interact = (type = 'click') => {
          if (navigator.vibrate) navigator.vibrate(type === 'success' ? [10, 30, 10] : 5);
          // Audio logic simplified for brevity
        };

        // --- Veri ---
        const CATEGORIES = [
            { id: 'people', title: 'İnsanlar & İlişkiler', items: ['vip', 'family', 'crisis'] },
            { id: 'planning', title: 'Planlama & Stil', items: ['style', 'day_exp', 'expectations', 'shotlist', 'must_have', 'negatives'] },
            { id: 'operation', title: 'Düğün Günü', items: ['ops', 'moments', 'final', 'post_ops'] }
        ];

        const SECTIONS = {
          vip: { id: 'vip', title: 'Özel Konuklar', sub: 'VIP & Protokol', icon: Users },
          family: { id: 'family', title: 'Aile İlişkileri', sub: 'Hassas Durumlar', icon: Heart },
          moments: { id: 'moments', title: 'Kritik Anlar', sub: 'Akış & Sahne', icon: Camera },
          shotlist: { id: 'shotlist', title: 'Shotlist', sub: 'Zorunlu Kareler', icon: ListChecks },
          style: { id: 'style', title: 'Konsept & Stil', sub: 'Atmosfer', icon: Diamond },
          must_have: { id: 'must_have', title: 'Vazgeçilmezler', sub: 'Kesin İstekler', icon: Star },
          negatives: { id: 'negatives', title: 'İstenmeyenler', sub: 'Kırmızı Çizgi', icon: X },
          day_exp: { id: 'day_exp', title: 'Günün Ruhu', sub: 'Mod & Enerji', icon: Activity },
          expectations: { id: 'expectations', title: 'Beklentiler', sub: 'Genel Akış', icon: Sparkles },
          crisis: { id: 'crisis', title: 'Kriz Yönetimi', sub: 'Yetki Matrisi', icon: Shield },
          ops: { id: 'ops', title: 'Operasyon', sub: 'Zaman Çizelgesi', icon: Clock },
          final: { id: 'final', title: 'Final & Veda', sub: 'Kapanış', icon: CheckCircle },
          post_ops: { id: 'post_ops', title: 'Teslimat', sub: 'After Care', icon: Save },
        };

        const DATA_MAP = {
          'family': { list: ["Vefat / Anma Durumu", "Boşanmış Ebeveyn", "Yeniden Evlilik", "Aile İçi Gerginlikler", "Küslük / Mesafe", "Sağlık Hassasiyeti", "Psikolojik Hassasiyet"], social: ["Dini / Kültürel Hassasiyetler", "Alkol Servis Politikası", "Fotoğraf Yasağı"] },
          'moments': { list: ["Gelin Hazırlık", "Damat Hazırlık", "Aile ile İlk Karşılaşma", "First Look", "Portre Çekimi", "Nikah", "Giriş Show", "İlk Dans", "Pasta Kesimi"], org: ["Giriş Koreografisi", "Pasta Seremonisi", "Sürpriz Performans", "Konuşmalar"] },
          'shotlist': { list: ["Hazırlık Detayları", "Gelin & Anne Özel Anı", "Damat & Baba Özel Anı", "First Look Reaksiyonu", "Nikah Çıkış Yürüyüşü"], check: ["Highlight (Özet) Kilitlendi", "Negatif Liste Onaylandı"] },
          'must_have': { list: ["Aile Toplu Fotoğrafı", "Ebeveyn Özel Kareleri", "Nedime/Sağdıç Eğlence", "Mekan & Dekor Detayları", "Drone Çekimi", "Golden Hour"] },
          'negatives': { list: ["Zorlama Pozlar", "Sürekli Müdahale", "Kalabalık Grup Çekimleri", "Doğal Olmayan Işık/Flaş", "Kamera İle Göz Teması", "Yapay Mizansenler"] },
          'style': { list: ["Minimalist & Modern", "Sinematik & Duygusal", "Yüksek Enerji & Party", "Klasik & Zamansız", "Fashion & Editorial", "Belgesel & Doğal"] },
          'day_exp': { list: ["Sıfır Stres Politikası", "Sessiz İletişim", "Minimum Anons", "Bizi Koruyun (Tampon Bölge)", "Sürprizlere Açığız", "Akışta Esneklik"] },
          'ops': { list: ["Ekip Gelin Evinde", "Gelin Alma Tamamlandı", "Mekan Girişi Yapıldı", "Gelin Hazırlık Bitti", "Damat Hazırlık Bitti", "First Look Yapıldı", "Portre Çekimi Bitti", "Aile Çekimi Bitti", "Salon Hazır", "Konuk Karşılama", "Giriş Müziği Cue", "Nikah Memuru Hazır"] },
          'final': { list: ["Pasta Kesildi", "Final Shotlist Tamam", "After Party Geçişi", "Gelin/Damat Çıkışı", "Kapanış"] },
          'post_ops': { list: ["Ham Veri Yedeği", "Video Kurguya Girdi", "Fotoğraf Seçimi", "Teaser Teslimi", "Reel Teslimi", "Albüm Tasarım Onayı", "Baskı Teslimatı"] },
          'expectations': { list: ["Bizi yönlendirin", "Doğal akış istiyoruz", "Çok poz istemiyoruz", "Rahat, sakin ilerlesin", "Enerjik, eğlenceli olsun", "Editorial / şık dursun"] }
        };

        // --- Chatbot Logic ---
        const BOT_RESPONSES = {
            'default': "Bunu not aldım. Operasyon ekibine iletiyorum.",
            'kriz': "Kriz durumlarında önceliğimiz çiftin huzuru. Lütfen Kriz Matrisi bölümünden yetkili kişiyi arayın.",
            'gelin': "Gelin hanım için 'Günün Ruhu' bölümünde 'Sıfır Stres' modunu aktifleştirmenizi öneririm.",
            'fotoğraf': "Fotoğraf için 'Shotlist' ve 'Vazgeçilmezler' listesini tamamlamanız çok önemli.",
            'plan': "Planlama %85 oranında tamamlandı. Sadece 'Final' bölümünde eksikler var.",
            'merhaba': "Merhaba! Ben CRMonX Asistanı. Düğün planlamanda sana nasıl yardımcı olabilirim?"
        };

        // --- Components ---

        // Bottom Sheet Component
        const BottomSheet = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex flex-col justify-end">
                    <div className="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onClick={onClose} />
                    <div className="relative bg-[#FFFAF0] rounded-t-[2rem] p-6 shadow-2xl animate-slideUp max-h-[85vh] overflow-y-auto border-t border-gold/20">
                        <div className="w-12 h-1 bg-gray-300 rounded-full mx-auto mb-6 opacity-50" />
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="font-display text-2xl text-black">{title}</h3>
                            <button onClick={onClose} className="p-2 bg-gray-100 rounded-full hover:bg-gray-200"><X size={20}/></button>
                        </div>
                        {children}
                    </div>
                </div>
            );
        };

        const CheckboxItem = ({ label, isChecked, note, onToggle, onNoteChange }) => (
          <div className={`group transition-all duration-300 mb-3 ${isChecked ? 'opacity-70 order-last' : 'opacity-100'}`}>
            <div 
              className={`flex items-start p-4 rounded-xl cursor-pointer transition-all border ${isChecked ? 'bg-gray-50 border-transparent' : 'bg-white border-gray-100 shadow-sm hover:border-gold/30 hover:shadow-soft'}`}
              onClick={() => { onToggle(); interact(isChecked ? 'click' : 'success'); }}
            >
              <div className={`mt-0.5 w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 mr-4 transition-all duration-300 ${isChecked ? 'bg-gold border-gold' : 'border-gray-300 bg-transparent'}`}>
                {isChecked && <CheckCircle size={14} className="text-white" />}
              </div>
              <div className="flex-1">
                <span className={`text-sm font-manrope font-medium block leading-relaxed transition-colors ${isChecked ? 'text-gray-400 line-through' : 'text-gray-800'}`}>
                  {label}
                </span>
                
                {/* Note Area - Always visible if checked or has content, otherwise expandable */}
                {(isChecked || note) && (
                  <div className="mt-3 animate-fadeIn" onClick={(e) => e.stopPropagation()}>
                    <input
                      type="text"
                      placeholder="Not ekle..."
                      value={note || ''}
                      onChange={(e) => onNoteChange(e.target.value)}
                      className="w-full text-xs p-2 bg-transparent border-b border-gray-200 focus:border-gold outline-none text-gray-600 font-light italic"
                    />
                  </div>
                )}
              </div>
            </div>
          </div>
        );

        const Chatbot = ({ isOpen, onClose }) => {
            const [messages, setMessages] = useState([
                { id: 1, text: "Merhaba! Ben CRMonX Asistanı. Düğün sürecinde aklına takılan her şeyi bana sorabilirsin.", sender: 'bot' }
            ]);
            const [input, setInput] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(scrollToBottom, [messages, isTyping]);

            const handleSend = () => {
                if (!input.trim()) return;
                
                const userMsg = { id: Date.now(), text: input, sender: 'user' };
                setMessages(prev => [...prev, userMsg]);
                setInput('');
                setIsTyping(true);

                // Simulate AI Logic
                setTimeout(() => {
                    const lowerInput = userMsg.text.toLowerCase();
                    let responseText = BOT_RESPONSES.default;
                    
                    Object.keys(BOT_RESPONSES).forEach(key => {
                        if (lowerInput.includes(key)) responseText = BOT_RESPONSES[key];
                    });

                    setMessages(prev => [...prev, { id: Date.now() + 1, text: responseText, sender: 'bot' }]);
                    setIsTyping(false);
                    interact('success');
                }, 1500);
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-50 flex items-end justify-center pointer-events-none">
                    <div className="absolute inset-0 bg-black/20 backdrop-blur-sm pointer-events-auto" onClick={onClose} />
                    <div className="bg-white w-full h-[85vh] sm:h-[600px] sm:w-[400px] sm:mb-20 sm:rounded-3xl rounded-t-[2rem] shadow-2xl flex flex-col pointer-events-auto animate-slideUp border border-gold/20">
                        {/* Header */}
                        <div className="p-5 border-b border-gray-100 flex justify-between items-center bg-cream rounded-t-[2rem]">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-black rounded-full flex items-center justify-center text-gold shadow-lg">
                                    <Bot size={20} />
                                </div>
                                <div>
                                    <h3 className="font-display text-lg font-bold">CRMonX AI</h3>
                                    <p className="text-[10px] text-green-600 font-bold flex items-center gap-1"><span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Çevrimiçi</p>
                                </div>
                            </div>
                            <button onClick={onClose} className="p-2 bg-white rounded-full text-gray-400 hover:text-black hover:bg-gray-100"><X size={20}/></button>
                        </div>

                        {/* Messages */}
                        <div className="flex-1 overflow-y-auto p-5 space-y-4 bg-[#FFFAF0]">
                            {messages.map(msg => (
                                <div key={msg.id} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                    <div className={`max-w-[80%] p-4 text-sm shadow-sm ${msg.sender === 'user' ? 'bg-black text-white rounded-l-2xl rounded-tr-2xl rounded-br-sm' : 'bg-white text-gray-700 rounded-r-2xl rounded-tl-2xl rounded-bl-sm border border-gray-100'}`}>
                                        {msg.text}
                                    </div>
                                </div>
                            ))}
                            {isTyping && (
                                <div className="flex justify-start">
                                    <div className="bg-white p-4 rounded-r-2xl rounded-tl-2xl border border-gray-100 flex gap-1 items-center h-10 shadow-sm">
                                        <div className="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div>
                                        <div className="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div>
                                        <div className="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div>
                                    </div>
                                </div>
                            )}
                            <div ref={messagesEndRef} />
                        </div>

                        {/* Input */}
                        <div className="p-4 bg-white border-t border-gray-100 flex gap-2 rounded-b-none sm:rounded-b-3xl">
                            <input 
                                type="text" 
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && handleSend()}
                                placeholder="Bir şeyler yaz..." 
                                className="flex-1 bg-gray-50 border-none rounded-xl px-4 text-sm focus:ring-2 focus:ring-gold/20 outline-none"
                            />
                            <button onClick={handleSend} className="w-12 h-12 bg-gold text-white rounded-xl flex items-center justify-center hover:bg-[#bfa035] active:scale-95 transition-transform shadow-lg">
                                <Send size={20} />
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // --- Ana Uygulama ---

        function CeremonixApp() {
          const [currentView, setCurrentView] = useState('intro');
          const [userRole, setUserRole] = useState('user');
          const [activeSectionId, setActiveSectionId] = useState(null);
          
          const [showChat, setShowChat] = useState(false);
          const [showPanicModal, setShowPanicModal] = useState(false);
          const [showAddVipSheet, setShowAddVipSheet] = useState(false);
          const [panicReason, setPanicReason] = useState('');
          const [panicNote, setPanicNote] = useState('');
          
          const [vipList, setVipList] = useState(() => JSON.parse(localStorage.getItem('crm_vipList')) || []);
          const [checklistState, setChecklistState] = useState(() => JSON.parse(localStorage.getItem('crm_checklist')) || {});
          const [newPerson, setNewPerson] = useState({ name: '', relation: '', note: '', photo: null, tags: [] });

          useEffect(() => { localStorage.setItem('crm_vipList', JSON.stringify(vipList)); }, [vipList]);
          useEffect(() => { localStorage.setItem('crm_checklist', JSON.stringify(checklistState)); }, [checklistState]);

          // Helper Functions (Toggle, Note, Vip, Progress...)
          const toggleCheck = (id, label) => {
            const key = `${id}-${label}`;
            setChecklistState(prev => ({ ...prev, [key]: { ...prev[key], checked: !prev[key]?.checked } }));
          };

          const updateNote = (id, label, note) => {
            const key = `${id}-${label}`;
            setChecklistState(prev => ({ ...prev, [key]: { ...prev[key], note } }));
          };

          const addVip = () => {
            if(!newPerson.name) return;
            setVipList([...vipList, { ...newPerson, id: Date.now() }]);
            setNewPerson({ name: '', relation: '', note: '', photo: null, tags: [] });
            setShowAddVipSheet(false);
            interact('success');
          };

          const calculateProgress = (sectionId) => {
            const opts = DATA_MAP[sectionId];
            if (!opts) return 0;
            let allItems = [];
            Object.values(opts).forEach(list => allItems = [...allItems, ...list]);
            if (allItems.length === 0) return 0;
            let checkedCount = 0;
            allItems.forEach(item => { if (checklistState[`${sectionId}-${item}`]?.checked) checkedCount++; });
            return Math.round((checkedCount / allItems.length) * 100);
          };

          const calculateTotalProgress = () => {
             const allSections = Object.keys(SECTIONS);
             const total = allSections.reduce((acc, curr) => acc + calculateProgress(curr), 0);
             return Math.round(total / allSections.length);
          };

          const goBack = () => { setCurrentView('dashboard'); setActiveSectionId(null); };

          // --- Views ---

          const IntroView = () => (
             <div className="flex flex-col items-center justify-center h-full bg-cream p-8 relative overflow-hidden">
                <div className="absolute top-[-10%] right-[-20%] w-[150%] h-[60%] border-[1px] border-gold/10 rounded-full rotate-12" />
                <div className="absolute bottom-[-10%] left-[-20%] w-[150%] h-[60%] border-[1px] border-gold/10 rounded-full -rotate-12" />
                <div className="relative z-10 w-full max-w-sm text-center">
                    <h1 className="font-display text-8xl font-thin text-black mb-2 tracking-tight">CRMonX</h1>
                    <p className="font-manrope text-[10px] uppercase tracking-[0.6em] text-gold font-bold">Smart Wedding OS</p>
                    <div className="mt-12 bg-white/60 backdrop-blur-md rounded-3xl p-1.5 flex shadow-sm border border-white/50">
                        <button onClick={() => { setUserRole('user'); interact(); }} className={`flex-1 py-4 rounded-2xl text-xs font-bold uppercase tracking-widest transition-all ${userRole === 'user' ? 'bg-black text-white shadow-lg' : 'text-gray-400'}`}>Çift</button>
                        <button onClick={() => { setUserRole('admin'); interact(); }} className={`flex-1 py-4 rounded-2xl text-xs font-bold uppercase tracking-widest transition-all ${userRole === 'admin' ? 'bg-gold text-white shadow-lg' : 'text-gray-400'}`}>Yönetici</button>
                    </div>
                    <button onClick={() => { interact('success'); setCurrentView('dashboard'); }} className={`w-full mt-6 py-5 rounded-2xl text-xs font-bold uppercase tracking-[0.3em] text-white shadow-xl active:scale-[0.98] transition-all flex items-center justify-center gap-3 ${userRole === 'admin' ? 'bg-gold' : 'bg-black'}`}>Giriş Yap</button>
                </div>
            </div>
          );

          const DashboardView = () => (
            <div className="p-6 pb-32 bg-cream min-h-screen">
                {/* 10X Feature: Live Countdown & Status */}
                <div className="bg-white rounded-3xl p-6 shadow-soft border border-gold/10 mb-8 relative overflow-hidden">
                    <div className="absolute top-0 right-0 p-4 opacity-10"><CalendarCheck size={80} /></div>
                    <div className="relative z-10">
                        <div className="flex justify-between items-start mb-4">
                            <div>
                                <p className="text-xs text-gray-400 uppercase tracking-widest font-bold">Kalan Süre</p>
                                <h2 className="font-display text-4xl text-black mt-1">208 <span className="text-lg text-gold">Gün</span></h2>
                            </div>
                            <div className="text-right">
                                <p className="text-xs text-gray-400 uppercase tracking-widest font-bold">Hava Durumu</p>
                                <div className="flex items-center justify-end gap-2 mt-1">
                                    <Sun size={20} className="text-gold"/> <span className="font-display text-xl">24°</span>
                                </div>
                            </div>
                        </div>
                        <div className="w-full bg-gray-100 h-2 rounded-full overflow-hidden">
                            <div className="h-full bg-gradient-to-r from-gold to-yellow-300" style={{ width: `${calculateTotalProgress()}%` }}></div>
                        </div>
                        <p className="text-[10px] text-gray-400 mt-2 text-right font-bold">% {calculateTotalProgress()} Hazır</p>
                    </div>
                </div>

                {/* Categories */}
                <div className="space-y-8">
                    {CATEGORIES.map(cat => (
                        <div key={cat.id} className="animate-fadeIn">
                            <h3 className="font-manrope text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-4 ml-1 flex items-center gap-2">
                                <span className="w-1 h-1 rounded-full bg-gold"></span> {cat.title}
                            </h3>
                            <div className="grid grid-cols-2 gap-3">
                                {cat.items.map(itemId => {
                                    const section = SECTIONS[itemId];
                                    const progress = calculateProgress(itemId);
                                    const isComplete = progress === 100;
                                    
                                    return (
                                        <button 
                                            key={itemId}
                                            onClick={() => { interact(); setActiveSectionId(itemId); setCurrentView('section'); }}
                                            className={`relative bg-white p-5 rounded-3xl text-left border border-transparent hover:border-gold/30 transition-all shadow-soft group overflow-hidden ${isComplete ? 'opacity-70 grayscale' : ''}`}
                                        >
                                            <div className="flex justify-between items-start mb-4">
                                                <div className={`p-2.5 rounded-2xl ${isComplete ? 'bg-gold text-white' : 'bg-gray-50 text-gray-400 group-hover:text-gold group-hover:bg-gold/10'} transition-colors`}>
                                                    <section.icon size={20} strokeWidth={1.5} />
                                                </div>
                                                {isComplete && <div className="bg-green-100 text-green-700 p-1 rounded-full"><CheckCircle size={12}/></div>}
                                            </div>
                                            <h4 className="font-display text-lg text-black leading-tight mb-1">{section.title}</h4>
                                            <p className="font-manrope text-[10px] text-gray-400 uppercase tracking-wider">{section.sub}</p>
                                            
                                            {/* Mini Progress */}
                                            <div className="absolute bottom-0 left-0 w-full h-1 bg-gray-100">
                                                <div className="h-full bg-gold transition-all duration-1000" style={{ width: `${progress}%` }}></div>
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    ))}
                </div>
            </div>
          );

          const SectionView = () => {
            const section = SECTIONS[activeSectionId];
            const data = DATA_MAP[activeSectionId];
            const progress = calculateProgress(activeSectionId);
            
            // 10X Feature: Timeline View for Operations
            const isTimeline = activeSectionId === 'ops';

            return (
              <div className="bg-white min-h-screen pb-32">
                <div className="sticky top-0 bg-white/95 backdrop-blur-md z-20 border-b border-gray-100 pt-6 pb-4 px-6 safe-area-top shadow-sm">
                    <div className="flex justify-between items-center mb-4">
                        <button onClick={() => { interact(); goBack(); }} className="w-10 h-10 rounded-full border border-gray-100 flex items-center justify-center hover:bg-gray-50"><ArrowLeft size={20} className="text-gray-600"/></button>
                        <span className="font-manrope text-[10px] font-bold text-gold uppercase tracking-widest border border-gold/30 px-3 py-1 rounded-full">%{progress} Tamamlandı</span>
                    </div>
                    <div className="flex items-center gap-4">
                        <div className="p-3 bg-cream rounded-2xl text-gold"><section.icon size={28} strokeWidth={1} /></div>
                        <div><h2 className="font-display text-3xl text-black">{section.title}</h2><p className="text-xs text-gray-400">{section.sub}</p></div>
                    </div>
                </div>

                <div className="p-6">
                    {/* VIP Logic */}
                    {activeSectionId === 'vip' && (
                        <button onClick={() => setShowAddVipSheet(true)} className="w-full py-4 border border-dashed border-gray-300 rounded-2xl text-gray-400 font-medium flex items-center justify-center gap-2 hover:border-gold hover:text-gold hover:bg-gold/5 transition-all mb-6"><Plus size={18} /> Yeni Kişi Ekle</button>
                    )}

                    {/* Standard List */}
                    <div className="space-y-8 relative">
                        {isTimeline && <div className="absolute left-[19px] top-4 bottom-4 w-0.5 bg-gray-100 z-0"></div>}
                        
                        {data?.list && data.list.map((opt, idx) => (
                           <div key={opt} className={`relative z-10 ${isTimeline ? 'pl-2' : ''}`}>
                                {isTimeline && <div className="absolute left-[-24px] top-4 w-3 h-3 rounded-full bg-white border-2 border-gold shadow-sm z-10"></div>}
                                <CheckboxItem 
                                    key={opt} 
                                    label={opt} 
                                    isChecked={checklistState[`${activeSectionId}_main-${opt}`]?.checked} 
                                    note={checklistState[`${activeSectionId}_main-${opt}`]?.note} 
                                    onToggle={() => toggleCheck(`${activeSectionId}_main`, opt)} 
                                    onNoteChange={(val) => updateNote(`${activeSectionId}_main`, opt, val)} 
                                />
                           </div>
                        ))}
                        
                        {/* Render other sub-lists dynamically if they exist and NOT timeline */}
                        {!isTimeline && ['social', 'org', 'check'].map(subKey => data?.[subKey] && (
                            <div key={subKey}>
                                <h3 className="font-manrope text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 mt-8 border-t border-gray-100 pt-8">
                                    {subKey === 'social' ? 'Sosyal & Kültürel' : subKey === 'org' ? 'Organizasyon Detay' : 'Onaylar'}
                                </h3>
                                {data[subKey].map(opt => (
                                    <CheckboxItem 
                                        key={opt} label={opt} 
                                        isChecked={checklistState[`${activeSectionId}_${subKey}-${opt}`]?.checked} 
                                        note={checklistState[`${activeSectionId}_${subKey}-${opt}`]?.note}
                                        onToggle={() => toggleCheck(`${activeSectionId}_${subKey}`, opt)}
                                        onNoteChange={(val) => updateNote(`${activeSectionId}_${subKey}`, opt, val)}
                                    />
                                ))}
                            </div>
                        ))}
                    </div>
                </div>
              </div>
            );
          };

          return (
            <div className="h-screen flex flex-col font-sans text-black overflow-hidden bg-cream">
              <main className="flex-1 overflow-y-auto no-scrollbar pb-24">
                {currentView === 'intro' && <IntroView />}
                {currentView === 'dashboard' && <DashboardView />}
                {currentView === 'section' && <SectionView />}
              </main>

              {/* Bottom Nav */}
              {currentView !== 'intro' && currentView !== 'section' && (
                <nav className="glass absolute bottom-0 w-full px-8 py-4 pb-8 border-t border-white/50 flex justify-between items-center z-30 safe-area-bottom">
                  <button onClick={() => { interact(); setCurrentView('dashboard'); }} className={`p-2 transition-colors ${currentView === 'dashboard' ? 'text-black' : 'text-gray-300'}`}><LayoutDashboard size={24} /></button>
                  <div className="absolute left-1/2 -translate-x-1/2 -top-6">
                    <button onClick={() => { interact('error'); setShowPanicModal(true); }} className="w-16 h-16 bg-black rounded-full flex items-center justify-center text-white shadow-2xl border-[6px] border-cream active:scale-95 transition-transform"><PhoneCall size={24} className="text-red-500" /></button>
                  </div>
                  <button onClick={() => { interact(); setCurrentView('profile'); }} className={`p-2 ${currentView === 'profile' ? 'text-black' : 'text-gray-300'}`}><User size={24} /></button>
                </nav>
              )}

              {/* 10X Feature: CHATBOT */}
              {currentView !== 'intro' && (
                <div className="fixed bottom-24 right-4 z-40">
                    <button 
                        onClick={() => setShowChat(true)} 
                        className="w-14 h-14 bg-gold rounded-full shadow-floating flex items-center justify-center text-white hover:scale-110 transition-transform animate-pulse-gold"
                    >
                        <Bot size={24} />
                    </button>
                </div>
              )}

              <Chatbot isOpen={showChat} onClose={() => setShowChat(false)} />

              {/* Modals & Sheets (Add VIP & Panic Modal same as before) */}
              <BottomSheet isOpen={showAddVipSheet} onClose={() => setShowAddVipSheet(false)} title="Özel Konuk Ekle">
                 <div className="space-y-6 pb-8">
                    <input type="text" placeholder="İsim Soyisim" className="w-full bg-transparent border-b border-gray-200 py-3 text-lg font-display text-black focus:outline-none focus:border-gold" value={newPerson.name} onChange={e => setNewPerson({...newPerson, name: e.target.value})} />
                    <button onClick={addVip} className="w-full bg-black text-white py-4 rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-gold transition-colors">Kaydet</button>
                 </div>
              </BottomSheet>
              
               {showPanicModal && (
                <div className="fixed inset-0 bg-black/90 z-50 flex items-end sm:items-center justify-center p-0 sm:p-6 backdrop-blur-md animate-fadeIn">
                  <div className="bg-cream w-full sm:rounded-[2rem] rounded-t-[2rem] p-8 relative shadow-2xl animate-slideUp border-t border-gold/50">
                    <button onClick={() => setShowPanicModal(false)} className="absolute top-6 right-6 p-2 bg-gray-100 rounded-full text-gray-400 hover:text-black"><X size={20} /></button>
                    <div className="text-center mb-8">
                      <div className="w-16 h-16 bg-red-50 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse"><AlertTriangle size={32} /></div>
                      <h3 className="font-display text-3xl text-black">ACİL YARDIM</h3>
                      <p className="font-manrope text-xs text-gray-400 uppercase tracking-widest mt-1">Operasyon Ekibine Bağlan</p>
                    </div>
                    <button onClick={() => { interact('success'); window.location.href = `https://wa.me/905325614593?text=ACİL DURUM`; setShowPanicModal(false); }} className={`w-full py-5 rounded-2xl text-xs font-bold uppercase tracking-[0.2em] transition-all flex items-center justify-center gap-3 bg-red-600 text-white shadow-xl`}>WhatsApp Bildir</button>
                  </div>
                </div>
              )}
            </div>
          );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<CeremonixApp />);
    </script>
</body>
</html>
